data.frame() %>%
tidyr::pivot_longer(c('A','T','C','G'))
Biostrings::alphabetFrequency(osaBound.seq, as.prob = T, baseOnly = T) %>%
data.frame() %>%
tidyr::pivot_longer(c('A','T','C','G')) %>%
ggplot(aes(other, value, color = name)) +
geom_point()
Biostrings::alphabetFrequency(osaBound.seq, as.prob = T, baseOnly = T) %>%
data.frame() %>%
tidyr::pivot_longer(c('A','T','C','G')) %>%
ggplot(aes(other, name, color = value)) +
geom_point()
Biostrings::alphabetFrequency(osaBound.seq, as.prob = T, baseOnly = T) %>%
data.frame()
Biostrings::alphabetFrequency(osaBound.seq, as.prob = T, baseOnly = T) %>%
data.frame() %>%
dplyr::select(!'other')
Biostrings::alphabetFrequency(osaBound.seq, as.prob = T, baseOnly = T) %>%
data.frame() %>%
dplyr::select(!'other') %>%
dplyr::mutate(id = 1:nrow(.)) %>%
tidyr::pivot_longer(c('A','T','C','G'))
Biostrings::alphabetFrequency(osaBound.seq, as.prob = T, baseOnly = T) %>%
data.frame()
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq)
osaBound.seq = osaPeaks %>%
resize(250, "center") %>%
#  data.frame() %>%
memes::get_sequence(dm6)
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq)
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame()
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame() %>%
ggplot(aes('', .)) +
geom_boxplot()
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .) %>%
ggplot(aes('', )) +
geom_boxplot()
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .)
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .) %>%
ggplot(aes('', values)) +
geom_boxplot()
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .) %>%
ggplot(aes('', values)) +
geom_boxplot(stat = 'identity')
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .) %>%
ggplot(aes('', values)) +
geom_point()
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .)
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .) %>%
ggplot(aes('', values))
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .) %>%
ggplot()
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .)
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .) %>%
dplyr::mutate(x = 1)
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .) %>%
dplyr::mutate(x = 'butt')
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .) %>%
dplyr::mutate(test = 'butt')
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
test <- Biostrings::vcountPattern('AT', osaBound.seq) / width(osaBound.seq) %>%
data.frame(values = .)
test
test %>%
ggplot()
test %>%
ggplot(aes('', values))
test %>%
ggplot(aes('', values)) %>%
geom_point()
test %>%
ggplot(aes('', values)) +
geom_point()
test %>%
ggplot(aes('', values)) +
geom_boxplot(stat = 'identity')
test %>%
ggplot(aes('', values)) +
geom_violin()
osaBound.center.seq = osaPeaks %>%
resize(100, "center") %>%
#  data.frame() %>%
memes::get_sequence(dm6)
osaBound.flank.seq = osaPeaks %>%
.+100 %>%
resize(100, "center")
osaBound.flank.seq = osaPeaks %>%
.+100
osaBound.flank.seq = osaPeaks %>%
shift(100)
osaBound.flank.seq = osaPeaks %>%
shift(100) %>%
resize(100, "center")
osaBound.flank.up.seq = osaPeaks %>%
shift(100) %>%
resize(100, "center")
osaBound.flank.down.seq = osaPeaks %>%
shift(-100) %>%
resize(100, "center")
osaBound.center.seq = osaPeaks %>%
resize(250, "center") %>%
#  data.frame() %>%
memes::get_sequence(dm6)
osaBound.flank.up.seq = osaPeaks %>%
shift(250) %>%
resize(250, "center")
osaBound.flank.down.seq = osaPeaks %>%
shift(-250) %>%
resize(250, "center")
osaBound.center.at <- Biostrings::vcountPattern('AT', osaBound.center.seq) / width(osaBound.center.seq) %>%
data.frame(values = .) %>%
dplyr::mutate(grp = 'center')
osaBound.center.at <- Biostrings::vcountPattern('AT', osaBound.center.seq) / width(osaBound.center.seq) %>%
data.frame(values = .)
osaBound.center.at %<>%
dplyr::mutate(grp = 'center')
osaBound.flank.up.at <- Biostrings::vcountPattern('AT', osaBound.flank.up.seq) / width(osaBound.flank.up.seq) %>%
data.frame(values = .)
osaBound.center.seq = osaPeaks %>%
resize(250, "center") %>%
memes::get_sequence(dm6)
osaBound.flank.up.seq = osaPeaks %>%
shift(250) %>%
resize(250, "center") %>%
memes::get_sequence(dm6)
osaBound.flank.down.seq = osaPeaks %>%
shift(-250) %>%
resize(250, "center") %>%
memes::get_sequence(dm6)
# freqIslands = vcountPattern("CG", seqChr8Islands) / width(seqChr8Islands)
osaBound.center.at <- Biostrings::vcountPattern('AT', osaBound.center.seq) / width(osaBound.center.seq) %>%
data.frame(values = .)
osaBound.center.at %<>%
dplyr::mutate(grp = 'center')
osaBound.flank.up.at <- Biostrings::vcountPattern('AT', osaBound.flank.up.seq) / width(osaBound.flank.up.seq) %>%
data.frame(values = .)
osaBound.flank.up.at %<>%
dplyr::mutate(grp = 'flank-up')
osaBound.flank.down.at <- Biostrings::vcountPattern('AT', osaBound.flank.down.seq) / width(osaBound.flank.down.seq) %>%
data.frame(values = .)
osaBound.flank.down.at %<>%
dplyr::mutate(grp = 'flank-down')
dplyr::bind_rows(osaBound.center.at,
osaBound.flank.up.at,
osaBound.flank.down.at)
test <- dplyr::bind_rows(osaBound.center.at,
osaBound.flank.up.at,
osaBound.flank.down.at)
test %>%
ggplot(aes('', values)) +
geom_violin()
test %>%
ggplot(aes(grp, values)) +
geom_violin()
test %>%
ggplot(aes(grp, values)) +
geom_violin() %>%
geom_point(alpha = 0.4)
test %>%
ggplot(aes(grp, values)) +
geom_violin() +
geom_point(alpha = 0.4)
test %>%
ggplot(aes(grp, values)) +
geom_violin() +
geom_point(alpha = 0.4, position = position_jitterdodge())
test %>%
ggplot(aes(grp, values)) +
geom_violin() +
geom_point(alpha = 0.4, position = position_jitterdodge(width = 0.2))
test %>%
ggplot(aes(grp, values)) +
geom_violin() +
geom_point(alpha = 0.4, position = position_jitter)
test %>%
ggplot(aes(grp, values)) +
geom_violin() +
geom_point(alpha = 0.4, position = position_jitter())
test %>%
ggplot(aes(grp, values)) +
geom_violin() +
geom_point(alpha = 0.4, position = position_jitter(width = 0.3))
test %>%
ggplot(aes(grp, values)) +
geom_violin() +
geom_point(alpha = 0.4, position = position_jitter(width = 0.2))
osaBound.seq = osaPeaks %>%
resize(3000, "center") %>%
memes::get_sequence(dm6)
osaBound.seq.df <- osaBound.seq %>%
data.frame()
colnames(osaBound.seq.df) <- 'seqs'
osaBound.seq.split <- stringr::str_split(osaBound.seq.df$seqs, pattern = '', simplify = T) %>%
data.frame()
colnames(osaBound.seq.split) <- as.character(c(1:3000))
osaBound.df <- dplyr::bind_cols(osaBound.seq.split, data.frame(osaPeaks))
osaBound.df %>%
tidyr::pivot_longer(c(1:2000)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally()
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally()
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq)) +
ylim(c(0,1)) +
geom_point(alpha = 0.2) +
geom_smooth(method = 'loess', span = 0.1)
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, fill = value)) +
ylim(c(0,1)) +
geom_point(alpha = 0.2)
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0,1)) +
geom_point(alpha = 0.2)
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0,1)) +
geom_point(alpha = 0.2)
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.1,0.3)) +
geom_point(alpha = 0.2)
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.15,0.35)) +
geom_point(alpha = 0.2)
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.15,0.35)) +
geom_point(alpha = 0.2) +
scale_fill_brewer(palette = 'Spectral')
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.15,0.35)) +
geom_point(alpha = 0.2) +
scale_fill_manual(values = c('#D81B60','#1E88E5','#FFC107','#004D40'))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.15,0.35)) +
geom_point(alpha = 0.2) +
scale_color_manual(values = c('#D81B60','#1E88E5','#FFC107','#004D40'))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.15,0.35)) +
geom_point(alpha = 0.2) +
scale_color_manual(values = c('#D81B60','#1E88E5','#FFC107','#004D40','black'))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.15,0.35)) +
geom_point(alpha = 0.2) +
scale_color_manual(values = c('#D81B60','#FFC107','#004D40','black','#1E88E5'))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.15,0.35)) +
geom_point(alpha = 0.2) +
scale_color_manual(values = c('#D81B60','#FFC107','black','#004D40','#1E88E5'))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.15,0.35)) +
geom_point(alpha = 0.2) +
scale_color_manual(values = c('#D81B60','black','#FFC107','#004D40','#1E88E5'))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.15,0.35)) +
geom_point(alpha = 0.2) +
scale_color_manual(values = c('#D81B60','red','#FFC107','#004D40','#1E88E5'))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.15,0.35)) +
geom_point(alpha = 0.2) +
scale_color_manual(values = c('#D81B60','#004D40','#FFC107','black','#1E88E5'))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::filter(value != 'N') %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.15,0.35)) +
geom_point(alpha = 0.2) +
scale_color_manual(values = c('#D81B60','#004D40','#FFC107','#1E88E5'))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally()
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::filter(value != 'N') %>%
dplyr::mutate(freq = n/sum(n))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(peak,name, value) %>%
dplyr::tally() %>%
dplyr::filter(value != 'N')
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(peak, value) %>%
dplyr::tally() %>%
dplyr::filter(value != 'N')
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(peak, value) %>%
dplyr::tally() %>%
dplyr::filter(value != 'N') %>%
dplyr::mutate(freq = n/sum(n))
osaBound.df %>%
tidyr::pivot_longer(c(1:3000)) %>%
dplyr::mutate(name = as.integer(name)) %>%
#dplyr::mutate(GC = ifelse(value == 'G' | value == 'C', T, F),
#              AT = ifelse(value == 'T' | value == 'A', T, F),
#              name = as.integer(name))
dplyr::group_by(name, value) %>%
dplyr::tally() %>%
dplyr::filter(value != 'N') %>%
dplyr::mutate(freq = n/sum(n)) %>%
ggplot(aes(name, freq, color = value)) +
ylim(c(0.15,0.35)) +
geom_point(alpha = 0.2) +
scale_color_manual(values = c('#D81B60','#004D40','#FFC107','#1E88E5'))
