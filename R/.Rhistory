color_lookup <- data.frame(complex = complexlist, hex = c(cbPalette,'black'))
replicate_sheet <- read.csv('Data/rnaiScreen_replicate_wings.csv') %>%
dplyr::mutate(replicate = paste(symbol, line, date, drop, sep = '_'))
rnaiScreen_filtered <- rnaiScreen %>%
dplyr::mutate(replicate = paste(symbol, line, date, scene, sep = '_')) %>%
dplyr::filter(!replicate %in% replicate_sheet$replicate | sampleID == 'osa_31266_210503') %>% # filter out replicate images, or 31266_210503 -- images of 3LW
dplyr:: mutate(complex = dplyr::case_when(symbol %in% ACF ~ 'ACF',
symbol %in% INO80 ~ 'INO80',
symbol %in% ATAC ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% NURD ~ 'NURD',
symbol %in% Domino ~ 'Domino',
symbol %in% SWISNF ~ 'Swi/Snf',
symbol %in% SNF_2like ~ 'SNF2-like',
symbol %in% control ~ 'control')) %>%
dplyr::inner_join(., color_lookup) %>%
dplyr::mutate(id = glue::glue("<i style='color:{hex};font-size:10pt'>{id}</i>"))
rnaiScreen_filtered
tables1 <- rnaiScreen_filtered %>%
dplyr::mutate(symbol = stringr::str_to_title(symbol)) %>%
dplyr::group_by(symbol, line) %>%
dplyr::summarise(m = mean(KDtoWT),
sd = sd(KDtoWT),
n = dplyr::n())
write.csv('rPlots/TableS1-data.csv', x = tables1)
rnaiScreen_filtered %>%
ggplot(aes(KDtoWT, forcats::fct_reorder(id, KDtoWT) )) +
geom_vline(xintercept = 1, color = "grey50") +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
scale_x_continuous(trans = "log2") + # trying out a log transformation rather than using the log2 FC data
xlab("brD KD/WT (log2 trans)") +
theme(#axis.text.y = element_text(size = 10),
axis.text.y = element_markdown(),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom',
plot.background = element_rect(fill='transparent'))
ggsave('rPlots/2D.png', width = 5, height = 8)
ACF <- c('Acf', 'Chrac-16')
SWISNF <- c('osa', 'Bap111', 'brm','polybromo','Snr1','Act5C','mor')
INO80 <- c('Arp5','Ino80','pho')
ATAC <- c('Atac2','Atac3','D12','NC2beta')
NURF <- c('Caf1-55','Nurf-38','E(bx)','ISWI')
NURD <- c('Mi-2','MTA1-like')
Domino <- c('dom','Nipped-A','pont','Tip60')
SNF_2like <- c('kis','okr','Etl1','Chd1','lexA') # including cotrol lexA here because it get's manually colored in the figure later
complexlist <- c('ACF','Swi/Snf','INO80','ATAC','NURF','NURD','Domino','SNF2-like','control')
colorlist <- RColorBrewer::brewer.pal(length(complexlist), 'Set1')
color_lookup <- data.frame(complex = complexlist, hex = c(cbPalette,'black'))
replicate_sheet <- read.csv('Data/rnaiScreen_replicate_wings.csv') %>%
dplyr::mutate(replicate = paste(symbol, line, date, drop, sep = '_'))
rnaiScreen_filtered <- rnaiScreen %>%
dplyr::mutate(replicate = paste(symbol, line, date, scene, sep = '_')) %>%
dplyr::filter(!replicate %in% replicate_sheet$replicate | sampleID == 'osa_31266_210503') %>% # filter out replicate images, or 31266_210503 -- images of 3LW
dplyr:: mutate(complex = dplyr::case_when(symbol %in% ACF ~ 'ACF',
symbol %in% INO80 ~ 'INO80',
symbol %in% ATAC ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% NURD ~ 'NURD',
symbol %in% Domino ~ 'Domino',
symbol %in% SWISNF ~ 'Swi/Snf',
symbol %in% SNF_2like ~ 'SNF2-like') %>%
dplyr::inner_join(., color_lookup) %>%
dplyr::mutate(id = glue::glue("<i style='color:{hex};font-size:10pt'>{id}</i>"))
rnaiScreen_filtered
ACF <- c('Acf', 'Chrac-16')
SWISNF <- c('osa', 'Bap111', 'brm','polybromo','Snr1','Act5C','mor')
INO80 <- c('Arp5','Ino80','pho')
ATAC <- c('Atac2','Atac3','D12','NC2beta')
NURF <- c('Caf1-55','Nurf-38','E(bx)','ISWI')
NURD <- c('Mi-2','MTA1-like')
Domino <- c('dom','Nipped-A','pont','Tip60')
SNF_2like <- c('kis','okr','Etl1','Chd1','lexA') # including cotrol lexA here because it get's manually colored in the figure later
complexlist <- c('ACF','Swi/Snf','INO80','ATAC','NURF','NURD','Domino','SNF2-like','control')
colorlist <- RColorBrewer::brewer.pal(length(complexlist), 'Set1')
color_lookup <- data.frame(complex = complexlist, hex = c(cbPalette,'black'))
replicate_sheet <- read.csv('Data/rnaiScreen_replicate_wings.csv') %>%
dplyr::mutate(replicate = paste(symbol, line, date, drop, sep = '_'))
rnaiScreen_filtered <- rnaiScreen %>%
dplyr::mutate(replicate = paste(symbol, line, date, scene, sep = '_')) %>%
dplyr::filter(!replicate %in% replicate_sheet$replicate | sampleID == 'osa_31266_210503') %>% # filter out replicate images, or 31266_210503 -- images of 3LW
dplyr:: mutate(complex = dplyr::case_when(symbol %in% ACF ~ 'ACF',
symbol %in% INO80 ~ 'INO80',
symbol %in% ATAC ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% NURD ~ 'NURD',
symbol %in% Domino ~ 'Domino',
symbol %in% SWISNF ~ 'Swi/Snf',
symbol %in% SNF_2like ~ 'SNF2-like')) %>%
dplyr::inner_join(., color_lookup) %>%
dplyr::mutate(id = glue::glue("<i style='color:{hex};font-size:10pt'>{id}</i>"))
rnaiScreen_filtered
tables1 <- rnaiScreen_filtered %>%
dplyr::mutate(symbol = stringr::str_to_title(symbol)) %>%
dplyr::group_by(symbol, line) %>%
dplyr::summarise(m = mean(KDtoWT),
sd = sd(KDtoWT),
n = dplyr::n())
write.csv('rPlots/TableS1-data.csv', x = tables1)
rnaiScreen_filtered %>%
ggplot(aes(KDtoWT, forcats::fct_reorder(id, KDtoWT) )) +
geom_vline(xintercept = 1, color = "grey50") +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
scale_x_continuous(trans = "log2") + # trying out a log transformation rather than using the log2 FC data
xlab("brD KD/WT (log2 trans)") +
theme(#axis.text.y = element_text(size = 10),
axis.text.y = element_markdown(),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom',
plot.background = element_rect(fill='transparent'))
ggsave('rPlots/2D.png', width = 5, height = 8)
ACF <- c('Acf', 'Chrac-16')
SWISNF <- c('osa', 'Bap111', 'brm','polybromo','Snr1','Act5C','mor')
INO80 <- c('Arp5','Ino80','pho')
ATAC <- c('Atac2','Atac3','D12','NC2beta')
NURF <- c('Caf1-55','Nurf-38','E(bx)','ISWI')
NURD <- c('Mi-2','MTA1-like')
Domino <- c('dom','Nipped-A','pont','Tip60')
SNF_2like <- c('kis','okr','Etl1','Chd1','lexA') # including cotrol lexA here because it get's manually colored in the figure later
complexlist <- c('ACF','Swi/Snf','INO80','ATAC','NURF','NURD','Domino','SNF2-like','control')
colorlist <- RColorBrewer::brewer.pal(length(complexlist), 'Set1')
color_lookup <- data.frame(complex = complexlist, hex = c('black',cbPalette))
replicate_sheet <- read.csv('Data/rnaiScreen_replicate_wings.csv') %>%
dplyr::mutate(replicate = paste(symbol, line, date, drop, sep = '_'))
rnaiScreen_filtered <- rnaiScreen %>%
dplyr::mutate(replicate = paste(symbol, line, date, scene, sep = '_')) %>%
dplyr::filter(!replicate %in% replicate_sheet$replicate | sampleID == 'osa_31266_210503') %>% # filter out replicate images, or 31266_210503 -- images of 3LW
dplyr:: mutate(complex = dplyr::case_when(symbol %in% ACF ~ 'ACF',
symbol %in% INO80 ~ 'INO80',
symbol %in% ATAC ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% NURD ~ 'NURD',
symbol %in% Domino ~ 'Domino',
symbol %in% SWISNF ~ 'Swi/Snf',
symbol %in% SNF_2like ~ 'SNF2-like')) %>%
dplyr::inner_join(., color_lookup) %>%
dplyr::mutate(id = glue::glue("<i style='color:{hex};font-size:10pt'>{id}</i>"))
rnaiScreen_filtered
tables1 <- rnaiScreen_filtered %>%
dplyr::mutate(symbol = stringr::str_to_title(symbol)) %>%
dplyr::group_by(symbol, line) %>%
dplyr::summarise(m = mean(KDtoWT),
sd = sd(KDtoWT),
n = dplyr::n())
write.csv('rPlots/TableS1-data.csv', x = tables1)
rnaiScreen_filtered %>%
ggplot(aes(KDtoWT, forcats::fct_reorder(id, KDtoWT) )) +
geom_vline(xintercept = 1, color = "grey50") +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
scale_x_continuous(trans = "log2") + # trying out a log transformation rather than using the log2 FC data
xlab("brD KD/WT (log2 trans)") +
theme(#axis.text.y = element_text(size = 10),
axis.text.y = element_markdown(),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom',
plot.background = element_rect(fill='transparent'))
ggsave('rPlots/2D.png', width = 5, height = 8)
cbPalette <- c(, "#E69F00", "#999999","black","#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
cbPalette <- c("#E69F00", "#999999","black","#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
ACF <- c('Acf', 'Chrac-16')
SWISNF <- c('osa', 'Bap111', 'brm','polybromo','Snr1','Act5C','mor')
INO80 <- c('Arp5','Ino80','pho')
ATAC <- c('Atac2','Atac3','D12','NC2beta')
NURF <- c('Caf1-55','Nurf-38','E(bx)','ISWI')
NURD <- c('Mi-2','MTA1-like')
Domino <- c('dom','Nipped-A','pont','Tip60')
SNF_2like <- c('kis','okr','Etl1','Chd1','lexA') # including cotrol lexA here because it get's manually colored in the figure later
complexlist <- c('ACF','Swi/Snf','INO80','ATAC','NURF','NURD','Domino','SNF2-like','control')
colorlist <- RColorBrewer::brewer.pal(length(complexlist), 'Set1')
color_lookup <- data.frame(complex = complexlist, hex = c('black',cbPalette))
cbPalette <- c("#E69F00", "black","#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
ACF <- c('Acf', 'Chrac-16')
SWISNF <- c('osa', 'Bap111', 'brm','polybromo','Snr1','Act5C','mor')
INO80 <- c('Arp5','Ino80','pho')
ATAC <- c('Atac2','Atac3','D12','NC2beta')
NURF <- c('Caf1-55','Nurf-38','E(bx)','ISWI')
NURD <- c('Mi-2','MTA1-like')
Domino <- c('dom','Nipped-A','pont','Tip60')
SNF_2like <- c('kis','okr','Etl1','Chd1','lexA') # including cotrol lexA here because it get's manually colored in the figure later
complexlist <- c('ACF','Swi/Snf','INO80','ATAC','NURF','NURD','Domino','SNF2-like','control')
colorlist <- RColorBrewer::brewer.pal(length(complexlist), 'Set1')
color_lookup <- data.frame(complex = complexlist, hex = c('black',cbPalette))
replicate_sheet <- read.csv('Data/rnaiScreen_replicate_wings.csv') %>%
dplyr::mutate(replicate = paste(symbol, line, date, drop, sep = '_'))
rnaiScreen_filtered <- rnaiScreen %>%
dplyr::mutate(replicate = paste(symbol, line, date, scene, sep = '_')) %>%
dplyr::filter(!replicate %in% replicate_sheet$replicate | sampleID == 'osa_31266_210503') %>% # filter out replicate images, or 31266_210503 -- images of 3LW
dplyr:: mutate(complex = dplyr::case_when(symbol %in% ACF ~ 'ACF',
symbol %in% INO80 ~ 'INO80',
symbol %in% ATAC ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% NURD ~ 'NURD',
symbol %in% Domino ~ 'Domino',
symbol %in% SWISNF ~ 'Swi/Snf',
symbol %in% SNF_2like ~ 'SNF2-like')) %>%
dplyr::inner_join(., color_lookup) %>%
dplyr::mutate(id = glue::glue("<i style='color:{hex};font-size:10pt'>{id}</i>"))
rnaiScreen_filtered
tables1 <- rnaiScreen_filtered %>%
dplyr::mutate(symbol = stringr::str_to_title(symbol)) %>%
dplyr::group_by(symbol, line) %>%
dplyr::summarise(m = mean(KDtoWT),
sd = sd(KDtoWT),
n = dplyr::n())
write.csv('rPlots/TableS1-data.csv', x = tables1)
rnaiScreen_filtered %>%
ggplot(aes(KDtoWT, forcats::fct_reorder(id, KDtoWT) )) +
geom_vline(xintercept = 1, color = "grey50") +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
scale_x_continuous(trans = "log2") + # trying out a log transformation rather than using the log2 FC data
xlab("brD KD/WT (log2 trans)") +
theme(#axis.text.y = element_text(size = 10),
axis.text.y = element_markdown(),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom',
plot.background = element_rect(fill='transparent'))
ggsave('rPlots/2D.png', width = 5, height = 8)
cbPalette <- c("#E69F00", "#999999","black","#56B4E9", "#009E73", "#0072B2", "#D55E00", "#CC79A7")
ACF <- c('Acf', 'Chrac-16')
SWISNF <- c('osa', 'Bap111', 'brm','polybromo','Snr1','Act5C','mor')
INO80 <- c('Arp5','Ino80','pho')
ATAC <- c('Atac2','Atac3','D12','NC2beta')
NURF <- c('Caf1-55','Nurf-38','E(bx)','ISWI')
NURD <- c('Mi-2','MTA1-like')
Domino <- c('dom','Nipped-A','pont','Tip60')
SNF_2like <- c('kis','okr','Etl1','Chd1','lexA') # including cotrol lexA here because it get's manually colored in the figure later
complexlist <- c('ACF','Swi/Snf','INO80','ATAC','NURF','NURD','Domino','SNF2-like','control')
colorlist <- RColorBrewer::brewer.pal(length(complexlist), 'Set1')
color_lookup <- data.frame(complex = complexlist, hex = c('black',cbPalette))
replicate_sheet <- read.csv('Data/rnaiScreen_replicate_wings.csv') %>%
dplyr::mutate(replicate = paste(symbol, line, date, drop, sep = '_'))
rnaiScreen_filtered <- rnaiScreen %>%
dplyr::mutate(replicate = paste(symbol, line, date, scene, sep = '_')) %>%
dplyr::filter(!replicate %in% replicate_sheet$replicate | sampleID == 'osa_31266_210503') %>% # filter out replicate images, or 31266_210503 -- images of 3LW
dplyr:: mutate(complex = dplyr::case_when(symbol %in% ACF ~ 'ACF',
symbol %in% INO80 ~ 'INO80',
symbol %in% ATAC ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% NURD ~ 'NURD',
symbol %in% Domino ~ 'Domino',
symbol %in% SWISNF ~ 'Swi/Snf',
symbol %in% SNF_2like ~ 'SNF2-like')) %>%
dplyr::inner_join(., color_lookup) %>%
dplyr::mutate(id = glue::glue("<i style='color:{hex};font-size:10pt'>{id}</i>"))
rnaiScreen_filtered
tables1 <- rnaiScreen_filtered %>%
dplyr::mutate(symbol = stringr::str_to_title(symbol)) %>%
dplyr::group_by(symbol, line) %>%
dplyr::summarise(m = mean(KDtoWT),
sd = sd(KDtoWT),
n = dplyr::n())
write.csv('rPlots/TableS1-data.csv', x = tables1)
rnaiScreen_filtered %>%
ggplot(aes(KDtoWT, forcats::fct_reorder(id, KDtoWT) )) +
geom_vline(xintercept = 1, color = "grey50") +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
scale_x_continuous(trans = "log2") + # trying out a log transformation rather than using the log2 FC data
xlab("brD KD/WT (log2 trans)") +
theme(#axis.text.y = element_text(size = 10),
axis.text.y = element_markdown(),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom',
plot.background = element_rect(fill='transparent'))
ggsave('rPlots/2D.png', width = 5, height = 8)
cbPalette <- c( "#E69F00", "#999999","black","#56B4E9", "#009E73", "#D55E00", "#CC79A7")
ACF <- c('Acf', 'Chrac-16')
SWISNF <- c('osa', 'Bap111', 'brm','polybromo','Snr1','Act5C','mor')
INO80 <- c('Arp5','Ino80','pho')
ATAC <- c('Atac2','Atac3','D12','NC2beta')
NURF <- c('Caf1-55','Nurf-38','E(bx)','ISWI')
NURD <- c('Mi-2','MTA1-like')
Domino <- c('dom','Nipped-A','pont','Tip60')
SNF_2like <- c('kis','okr','Etl1','Chd1','lexA') # including cotrol lexA here because it get's manually colored in the figure later
complexlist <- c('ACF','Swi/Snf','INO80','ATAC','NURF','NURD','Domino','SNF2-like','control')
colorlist <- RColorBrewer::brewer.pal(length(complexlist), 'Set1')
color_lookup <- data.frame(complex = complexlist, hex = c('black',cbPalette))
cbPalette <- c( "#0072B2", "#E69F00", "#999999","black","#56B4E9", "#009E73", "#D55E00", "#CC79A7")
ACF <- c('Acf', 'Chrac-16')
SWISNF <- c('osa', 'Bap111', 'brm','polybromo','Snr1','Act5C','mor')
INO80 <- c('Arp5','Ino80','pho')
ATAC <- c('Atac2','Atac3','D12','NC2beta')
NURF <- c('Caf1-55','Nurf-38','E(bx)','ISWI')
NURD <- c('Mi-2','MTA1-like')
Domino <- c('dom','Nipped-A','pont','Tip60')
SNF_2like <- c('kis','okr','Etl1','Chd1','lexA') # including cotrol lexA here because it get's manually colored in the figure later
complexlist <- c('ACF','Swi/Snf','INO80','ATAC','NURF','NURD','Domino','SNF2-like','control')
colorlist <- RColorBrewer::brewer.pal(length(complexlist), 'Set1')
color_lookup <- data.frame(complex = complexlist, hex = c('black',cbPalette))
replicate_sheet <- read.csv('Data/rnaiScreen_replicate_wings.csv') %>%
dplyr::mutate(replicate = paste(symbol, line, date, drop, sep = '_'))
rnaiScreen_filtered <- rnaiScreen %>%
dplyr::mutate(replicate = paste(symbol, line, date, scene, sep = '_')) %>%
dplyr::filter(!replicate %in% replicate_sheet$replicate | sampleID == 'osa_31266_210503') %>% # filter out replicate images, or 31266_210503 -- images of 3LW
dplyr:: mutate(complex = dplyr::case_when(symbol %in% ACF ~ 'ACF',
symbol %in% INO80 ~ 'INO80',
symbol %in% ATAC ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% NURD ~ 'NURD',
symbol %in% Domino ~ 'Domino',
symbol %in% SWISNF ~ 'Swi/Snf',
symbol %in% SNF_2like ~ 'SNF2-like')) %>%
dplyr::inner_join(., color_lookup) %>%
dplyr::mutate(id = glue::glue("<i style='color:{hex};font-size:10pt'>{id}</i>"))
rnaiScreen_filtered
tables1 <- rnaiScreen_filtered %>%
dplyr::mutate(symbol = stringr::str_to_title(symbol)) %>%
dplyr::group_by(symbol, line) %>%
dplyr::summarise(m = mean(KDtoWT),
sd = sd(KDtoWT),
n = dplyr::n())
write.csv('rPlots/TableS1-data.csv', x = tables1)
rnaiScreen_filtered %>%
ggplot(aes(KDtoWT, forcats::fct_reorder(id, KDtoWT) )) +
geom_vline(xintercept = 1, color = "grey50") +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
scale_x_continuous(trans = "log2") + # trying out a log transformation rather than using the log2 FC data
xlab("brD KD/WT (log2 trans)") +
theme(#axis.text.y = element_text(size = 10),
axis.text.y = element_markdown(),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom',
plot.background = element_rect(fill='transparent'))
ggsave('rPlots/2D.png', width = 5, height = 8)
cbPalette <- c( "#0072B2",  "#999999","#E69F00","black","#56B4E9", "#009E73", "#D55E00", "#CC79A7")
ACF <- c('Acf', 'Chrac-16')
SWISNF <- c('osa', 'Bap111', 'brm','polybromo','Snr1','Act5C','mor')
INO80 <- c('Arp5','Ino80','pho')
ATAC <- c('Atac2','Atac3','D12','NC2beta')
NURF <- c('Caf1-55','Nurf-38','E(bx)','ISWI')
NURD <- c('Mi-2','MTA1-like')
Domino <- c('dom','Nipped-A','pont','Tip60')
SNF_2like <- c('kis','okr','Etl1','Chd1','lexA') # including cotrol lexA here because it get's manually colored in the figure later
complexlist <- c('ACF','Swi/Snf','INO80','ATAC','NURF','NURD','Domino','SNF2-like','control')
colorlist <- RColorBrewer::brewer.pal(length(complexlist), 'Set1')
color_lookup <- data.frame(complex = complexlist, hex = c('black',cbPalette))
replicate_sheet <- read.csv('Data/rnaiScreen_replicate_wings.csv') %>%
dplyr::mutate(replicate = paste(symbol, line, date, drop, sep = '_'))
rnaiScreen_filtered <- rnaiScreen %>%
dplyr::mutate(replicate = paste(symbol, line, date, scene, sep = '_')) %>%
dplyr::filter(!replicate %in% replicate_sheet$replicate | sampleID == 'osa_31266_210503') %>% # filter out replicate images, or 31266_210503 -- images of 3LW
dplyr:: mutate(complex = dplyr::case_when(symbol %in% ACF ~ 'ACF',
symbol %in% INO80 ~ 'INO80',
symbol %in% ATAC ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% NURD ~ 'NURD',
symbol %in% Domino ~ 'Domino',
symbol %in% SWISNF ~ 'Swi/Snf',
symbol %in% SNF_2like ~ 'SNF2-like')) %>%
dplyr::inner_join(., color_lookup) %>%
dplyr::mutate(id = glue::glue("<i style='color:{hex};font-size:10pt'>{id}</i>"))
rnaiScreen_filtered
tables1 <- rnaiScreen_filtered %>%
dplyr::mutate(symbol = stringr::str_to_title(symbol)) %>%
dplyr::group_by(symbol, line) %>%
dplyr::summarise(m = mean(KDtoWT),
sd = sd(KDtoWT),
n = dplyr::n())
write.csv('rPlots/TableS1-data.csv', x = tables1)
rnaiScreen_filtered %>%
ggplot(aes(KDtoWT, forcats::fct_reorder(id, KDtoWT) )) +
geom_vline(xintercept = 1, color = "grey50") +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
scale_x_continuous(trans = "log2") + # trying out a log transformation rather than using the log2 FC data
xlab("brD KD/WT (log2 trans)") +
theme(#axis.text.y = element_text(size = 10),
axis.text.y = element_markdown(),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom',
plot.background = element_rect(fill='transparent'))
ggsave('rPlots/2D.png', width = 5, height = 8)
cbPalette <- c( "#0072B2", ,"#E69F00","black","#56B4E9", "#999999" ,"#009E73", "#D55E00", "#CC79A7")
cbPalette <- c( "#0072B2","#E69F00","black","#56B4E9", "#999999" ,"#009E73", "#D55E00", "#CC79A7")
ACF <- c('Acf', 'Chrac-16')
SWISNF <- c('osa', 'Bap111', 'brm','polybromo','Snr1','Act5C','mor')
INO80 <- c('Arp5','Ino80','pho')
ATAC <- c('Atac2','Atac3','D12','NC2beta')
NURF <- c('Caf1-55','Nurf-38','E(bx)','ISWI')
NURD <- c('Mi-2','MTA1-like')
Domino <- c('dom','Nipped-A','pont','Tip60')
SNF_2like <- c('kis','okr','Etl1','Chd1','lexA') # including cotrol lexA here because it get's manually colored in the figure later
complexlist <- c('ACF','Swi/Snf','INO80','ATAC','NURF','NURD','Domino','SNF2-like','control')
colorlist <- RColorBrewer::brewer.pal(length(complexlist), 'Set1')
color_lookup <- data.frame(complex = complexlist, hex = c('black',cbPalette))
replicate_sheet <- read.csv('Data/rnaiScreen_replicate_wings.csv') %>%
dplyr::mutate(replicate = paste(symbol, line, date, drop, sep = '_'))
rnaiScreen_filtered <- rnaiScreen %>%
dplyr::mutate(replicate = paste(symbol, line, date, scene, sep = '_')) %>%
dplyr::filter(!replicate %in% replicate_sheet$replicate | sampleID == 'osa_31266_210503') %>% # filter out replicate images, or 31266_210503 -- images of 3LW
dplyr:: mutate(complex = dplyr::case_when(symbol %in% ACF ~ 'ACF',
symbol %in% INO80 ~ 'INO80',
symbol %in% ATAC ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% NURD ~ 'NURD',
symbol %in% Domino ~ 'Domino',
symbol %in% SWISNF ~ 'Swi/Snf',
symbol %in% SNF_2like ~ 'SNF2-like')) %>%
dplyr::inner_join(., color_lookup) %>%
dplyr::mutate(id = glue::glue("<i style='color:{hex};font-size:10pt'>{id}</i>"))
rnaiScreen_filtered
tables1 <- rnaiScreen_filtered %>%
dplyr::mutate(symbol = stringr::str_to_title(symbol)) %>%
dplyr::group_by(symbol, line) %>%
dplyr::summarise(m = mean(KDtoWT),
sd = sd(KDtoWT),
n = dplyr::n())
write.csv('rPlots/TableS1-data.csv', x = tables1)
rnaiScreen_filtered %>%
ggplot(aes(KDtoWT, forcats::fct_reorder(id, KDtoWT) )) +
geom_vline(xintercept = 1, color = "grey50") +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
scale_x_continuous(trans = "log2") + # trying out a log transformation rather than using the log2 FC data
xlab("brD KD/WT (log2 trans)") +
theme(#axis.text.y = element_text(size = 10),
axis.text.y = element_markdown(),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom',
plot.background = element_rect(fill='transparent'))
ggsave('rPlots/2D.png', width = 5, height = 8)
cbPalette <- c( "#0072B2","#E69F00","black","#56B4E9","#009E73", "#999999","#D55E00", "#CC79A7")
ACF <- c('Acf', 'Chrac-16')
SWISNF <- c('osa', 'Bap111', 'brm','polybromo','Snr1','Act5C','mor')
INO80 <- c('Arp5','Ino80','pho')
ATAC <- c('Atac2','Atac3','D12','NC2beta')
NURF <- c('Caf1-55','Nurf-38','E(bx)','ISWI')
NURD <- c('Mi-2','MTA1-like')
Domino <- c('dom','Nipped-A','pont','Tip60')
SNF_2like <- c('kis','okr','Etl1','Chd1','lexA') # including cotrol lexA here because it get's manually colored in the figure later
complexlist <- c('ACF','Swi/Snf','INO80','ATAC','NURF','NURD','Domino','SNF2-like','control')
colorlist <- RColorBrewer::brewer.pal(length(complexlist), 'Set1')
color_lookup <- data.frame(complex = complexlist, hex = c('black',cbPalette))
replicate_sheet <- read.csv('Data/rnaiScreen_replicate_wings.csv') %>%
dplyr::mutate(replicate = paste(symbol, line, date, drop, sep = '_'))
rnaiScreen_filtered <- rnaiScreen %>%
dplyr::mutate(replicate = paste(symbol, line, date, scene, sep = '_')) %>%
dplyr::filter(!replicate %in% replicate_sheet$replicate | sampleID == 'osa_31266_210503') %>% # filter out replicate images, or 31266_210503 -- images of 3LW
dplyr:: mutate(complex = dplyr::case_when(symbol %in% ACF ~ 'ACF',
symbol %in% INO80 ~ 'INO80',
symbol %in% ATAC ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% NURD ~ 'NURD',
symbol %in% Domino ~ 'Domino',
symbol %in% SWISNF ~ 'Swi/Snf',
symbol %in% SNF_2like ~ 'SNF2-like')) %>%
dplyr::inner_join(., color_lookup) %>%
dplyr::mutate(id = glue::glue("<i style='color:{hex};font-size:10pt'>{id}</i>"))
rnaiScreen_filtered
tables1 <- rnaiScreen_filtered %>%
dplyr::mutate(symbol = stringr::str_to_title(symbol)) %>%
dplyr::group_by(symbol, line) %>%
dplyr::summarise(m = mean(KDtoWT),
sd = sd(KDtoWT),
n = dplyr::n())
write.csv('rPlots/TableS1-data.csv', x = tables1)
rnaiScreen_filtered %>%
ggplot(aes(KDtoWT, forcats::fct_reorder(id, KDtoWT) )) +
geom_vline(xintercept = 1, color = "grey50") +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
scale_x_continuous(trans = "log2") + # trying out a log transformation rather than using the log2 FC data
xlab("brD KD/WT (log2 trans)") +
theme(#axis.text.y = element_text(size = 10),
axis.text.y = element_markdown(),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom',
plot.background = element_rect(fill='transparent'))
ggsave('rPlots/2D.png', width = 5, height = 8)
ACF <- c('Acf', 'Chrac-16')
SWISNF <- c('osa', 'Bap111', 'brm','polybromo','Snr1','Act5C','mor')
INO80 <- c('Arp5','Ino80','pho')
ATAC <- c('Atac2','Atac3','D12','NC2beta')
NURF <- c('Caf1-55','Nurf-38','E(bx)','ISWI')
NURD <- c('Mi-2','MTA1-like')
Domino <- c('dom','Nipped-A','pont','Tip60')
SNF_2like <- c('kis','okr','Etl1','Chd1','lexA') # including cotrol lexA here because it get's manually colored in the figure later
complexlist <- c('ACF','Swi/Snf','INO80','ATAC','NURF','NURD','Domino','SNF2-like','control')
colorlist <- RColorBrewer::brewer.pal(length(complexlist), 'Set1')
library(magrittr)
library(magrittr)
