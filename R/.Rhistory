memes::plot_ame_heatmap(id = motif_alt_id)
#using a slightly larger range becuase average peak size is closer to ~300bp - is this the right call?
osa.seq <- GRangesList(osaBound.closing = osaPeaks %>% dplyr::filter(faireCat.3LW_24h == 'closing') %>% dplyr::mutate(amecat = 'bound.closing'),
osaBound.static = osaPeaks %>% dplyr::filter(faireCat.3LW_24h == 'static') %>% dplyr::mutate(amecat = 'bound.static'),
osaUnbound.closing = osaUnbound %>% dplyr::filter(faireCat.3LW_24h == 'closing') %>% dplyr::mutate(amecat = 'unbound.closing')) %>%
resize(250, "center") %>%
memes::get_sequence(dm6)
osaBound.closing.ame <- memes::runAme(osa.seq, "osaBound.static")
osaBound.closing.ame %>%
dplyr::group_by(amecat)
osaBound.closing.ame %>%
dplyr::bind_rows(.id = 'amecat')
#using a slightly larger range becuase average peak size is closer to ~300bp - is this the right call?
osa.seq <- GRangesList(osaBound.closing = osaPeaks %>% dplyr::filter(faireCat.3LW_24h == 'closing'),
osaBound.static = osaPeaks %>% dplyr::filter(faireCat.3LW_24h == 'static'),
osaUnbound.closing = osaUnbound %>% dplyr::filter(faireCat.3LW_24h == 'closing')) %>%
resize(250, "center") %>%
memes::get_sequence(dm6)
#using a slightly larger range becuase average peak size is closer to ~300bp - is this the right call?
osa.seq <- GRangesList(osaBound.closing = osaPeaks %>% dplyr::filter(faireCat.3LW_24h == 'closing'),
osaBound.static = osaPeaks %>% dplyr::filter(faireCat.3LW_24h == 'static'),
osaUnbound.closing = osaUnbound %>% dplyr::filter(faireCat.3LW_24h == 'closing')) %>%
resize(250, "center") %>%
memes::get_sequence(dm6)
osaBound.closing.ame.staticControl <- memes::runAme(osa.seq$osaBound.closing, osa.seq$osaBound.static)
osaBound.closing.ame.staticControl <- memes::runAme(osa.seq$osaBound.closing, osa.seq$osaBound.static)
osaBound.closing.ame.unboundControl <- memes::runAme(osa.seq$osaBound.closing, osa.seq$osaUnbound.closing)
osa.seq$osaUnbound.closing
osa.seq$osaBound.closing
osaBound.ame <- osa.seq %>%
memes::runAme()
#using a slightly larger range becuase average peak size is closer to ~300bp - is this the right call?
osa.seq <- osaPeaks %>%
resize(250, "center") %>%
memes::get_sequence(dm6)
osaBound.ame <- osa.seq %>%
memes::runAme()
osaBound.ame %>%
dplyr::filter(rank %in% 1:10) %>%
memes::plot_ame_heatmap(id = motif_alt_id)
osaBound.ame
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_', n = 2)[[1]])
osaBound.ame
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_', n = 2)[[1]])
osaBound.ame
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_', n = 2)[[1]]) %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue))
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_', n = 2)[[1]])
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue))
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue)) %>%
memes::plot_ame_heatmap(id = motif_alt_id)
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:10) %>%
memes::plot_ame_heatmap(id = motif_alt_id)
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
memes::plot_ame_heatmap(id = motif_alt_id)
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
memes::plot_ame_heatmap(id = symbol)
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15)
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue))
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
ggplot(aes('Osa Bound', fill = neglogE)) +
geom_raster()
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
ggplot(aes('Osa Bound', symbol fill = neglogE)) +
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster()
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue),
symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster()
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue),
symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster()
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue),
symbol = forcats::fct_reorder(symbol, neglogE))
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue),
symbol = forcats::fct_reorder(symbol, neglogE)) %>% .$symbol
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue),
symbol = forcats::fct_reorder(symbol, neglogE))
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue),
symbol.fct = forcats::fct_reorder(symbol, neglogE))
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue),
symbol.fct = forcats::fct_reorder(symbol, neglogE)) %>% .$symbol.fct
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>% .$symbol
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>%
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>% .$symbol
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster()
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster()
#using a slightly larger range becuase average peak size is closer to ~300bp - is this the right call?
osa.seq <- osaPeaks %>%
resize(200, "center") %>%
memes::get_sequence(dm6)
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_', n = 2)[[1]])
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster()
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_brewer(palette = 'Spectral')
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis')
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis') +
theme(axis.text.y = element_text(size = 12))
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 12),
axis.title = element_blank())
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 12),
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 12),
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) %>%
ggsave('rPlots/3E_osaBound.png', width = 2, height = 4, dpi = 300)
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 12),
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
ggsave('rPlots/3E_osaBound.png', width = 2, height = 4, dpi = 300)
ggsave('rPlots/3E_osaBound.png', width = 2, height = 4, dpi = 300, scale = 2)
ggsave('rPlots/3E_osaBound.png', width = 4, height = 4, dpi = 300)
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 20),
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes(symbol, 'Osa Bound',fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.x = element_text(size = 20),
axis.title = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
ggsave('rPlots/3E_osaBound.png', width = 4, height = 4, dpi = 300)
ggsave('rPlots/3E_osaBound.png', width = 6, height = 4, dpi = 300)
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes(symbol, 'Osa Bound',fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.x = element_text(size = 12, angle = 90),
axis.title = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
ggsave('rPlots/3E_osaBound.png', width = 6, height = 4, dpi = 300)
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 12),
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
ggsave('rPlots/3E_osaBound.png', width = 4, height = 4, dpi = 300)
ggsave('rPlots/3E_osaBound.png', width = 6, height = 4, dpi = 300)
ggsave('rPlots/3E_osaBound.png', width = 4, height = 4, dpi = 300)
ggsave('rPlots/3E_osaBound.png', width = 5, height = 4, dpi = 300)
ggsave('rPlots/3E_osaBound.png', width = 4, height = 4, dpi = 300)
osaBound.ame
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_|-', n = 2)[[1]])
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:12) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 12),
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 12),
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
ggsave('rPlots/3E_osaBound.png', width = 4, height = 4, dpi = 300)
#using a slightly larger range becuase average peak size is closer to ~300bp - is this the right call?
osa.seq <- osaPeaks %>%
resize(100, "center") %>%
memes::get_sequence(dm6)
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_|-', n = 2)[[1]])
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 12),
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
#using a slightly larger range becuase average peak size is closer to ~300bp - is this the right call?
osa.seq <- osaPeaks %>%
resize(250, "center") %>%
memes::get_sequence(dm6)
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_|-', n = 2)[[1]])
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_|-', n = 2)[[1]])
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 12),
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
#using a slightly larger range becuase average peak size is closer to ~300bp - is this the right call?
osa.seq <- osaPeaks %>%
resize(200, "center") %>%
memes::get_sequence(dm6)
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_|-', n = 2)[[1]])
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_|-', n = 2)[[1]])
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 12),
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
osaBound.ame <- osa.seq %>%
memes::runAme(database = '~/McKay/Motif_databases/FLY/fly_factor_survey.meme') %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_|-', n = 2)[[1]])
osaBound.ame <- osa.seq %>%
memes::runAme(database = '/Users/m/McKay/Motif_databases/FLY/fly_factor_survey.meme') %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_|-', n = 2)[[1]])
###
# meme db
###
#TODO - so clunky...
# loading in the fly factor database, drop out a couple of problematic fbgn
# then use the fbgn.validated lookup table for fly factor to update all the old ids to correct ids
# then filter on the on gene list -- which has to go through a similar process of id validation
# gross
meme_db <- universalmotif::read_meme('~/McKay/Motif_databases/FLY/fly_factor_survey.meme')
options(meme_db = universalmotif::to_list(meme_db_on, extrainfo = F))
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_|-', n = 2)[[1]])
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 12),
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
###
# meme db
###
#TODO - so clunky...
# loading in the fly factor database, drop out a couple of problematic fbgn
# then use the fbgn.validated lookup table for fly factor to update all the old ids to correct ids
# then filter on the on gene list -- which has to go through a similar process of id validation
# gross
meme_db <- universalmotif::read_meme('~/McKay/Motif_databases/FLY/fly_factor_survey.meme') %>%
universalmotif::to_df() %>%
dplyr::group_by(name) %>%
dplyr::filter(!grepl('FBgn0051782|FBgn0265182', name)) %>%  #drop this FBgn, problematic update to multiple new FBgns of pseudogenes
dplyr::mutate(basename = stringr::str_split_fixed(name, '_', n = 2)[[1]],
fbgn.validated = fbgn.validated[fbgn.validated$FlyFactor == basename,]$Validated)
options(meme_db = universalmotif::to_list(meme_db_on, extrainfo = F))
osaBound.ame <- osa.seq %>%
memes::runAme() %>%
dplyr::group_by(motif_alt_id) %>%
dplyr::mutate(symbol = stringr::str_split_fixed(motif_alt_id, '_|-', n = 2)[[1]])
osaBound.ame %>%
dplyr::group_by(symbol) %>%
dplyr::filter(adj.pvalue == min(adj.pvalue) & rank %in% 1:15) %>%
dplyr::mutate(neglogE = -log10(evalue)) %>%
dplyr::ungroup() %>% # fct_reorder fails with grouped data, so annoying
dplyr::mutate(symbol = forcats::fct_reorder(symbol, neglogE)) %>%
ggplot(aes('Osa Bound', symbol, fill = neglogE)) +
geom_raster() +
scale_fill_continuous(type = 'viridis', name = '-log(evalue)') +
theme(axis.text.y = element_text(size = 12),
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
ggsave('rPlots/3E_osaBound.png', width = 4, height = 4, dpi = 300)
osaBound.ame
memes::plot_sequence_heatmap(osaBound.seq)
memes::plot_sequence_heatmap
memes::plot_sequence_heatmap
memes::plot_sequence_heatmap(osaBound.seq)
#using a slightly larger range becuase average peak size is closer to ~300bp - is this the right call?
osa.seq <- osaPeaks %>%
resize(50, "center") %>%
memes::get_sequence(dm6)
memes::plot_sequence_heatmap(osaBound.seq)
osaBound.seq
memes::plot_sequence_heatmap(osa.seq)
memes::plot_sequence_heatmap(head(osa.seq))
memes::plot_sequence_heatmap(head(osa.seq) %>% data.frame())
