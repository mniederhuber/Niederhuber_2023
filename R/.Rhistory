#  data.frame() %>%
#  dplyr::filter(faireCat.osaDeGrad == 'Osa Dependent') %>%
#  GRanges()
#
#fairePeaks.osaIndependent <- fairePeaks.deg %>%
#  data.frame() %>%
#  dplyr::filter(faireCat.osaDeGrad == 'Osa Independent') %>%
#  GRanges()
#
#fairePeaks.osaEctopic <- fairePeaks.deg %>%
#  data.frame() %>%
#  dplyr::filter(faireCat.osaDeGrad == 'Osa Ectopic') %>%
#  GRanges()
## load bws
#TODO - cleanup - move matrices?
bws <- get_bws(dplyr::bind_rows(cnr.ss, faire.wt.ssPool), 'id')
deg.bws <- get_bws(faire.ss %>% dplyr::filter(experiment == 'osaGFP deGrad FAIRE'), 'id')
#TODO move data to main project directory and fix path
#TODO merge reps?
#k27ac.bw <- rtracklayer::import.bw('~/mckay/h3k27ac_cnr/bigwig/yw-3LW-wing-ak27ac-pel-Rep1_dm6_trim_q5_dupsRemoved_allFrags_rpgcNorm_zNorm.bw')
k27ac.bw <- rtracklayer::import.bw('~/mckay/H3K27ac_CnR/BigWig/yw-3LW-wing-ak27ac-pel-MEAN_dm6_trim_q5_dupsRemoved_150to700_rpgcNorm_zNorm.bw')
## functions
plot.frac <- function(x) {
lapply(unique(x$change), function(i) {
x %>%
dplyr::filter(change == i) %>%
ggplot(aes(fraction, change, fill = Osa.Bound)) +
geom_bar(stat = 'identity', width = 1) +
geom_text(aes(label = per), position = position_fill(vjust = 0.6),  size = 7, fontface = "bold") +
#geom_text(aes(label = per, position = position_stack(vjust = 0.5))) +
scale_fill_manual(values = c('grey80','#41f0ad'), name = 'Osa Bound') +
scale_y_discrete(position = 'right', ) +
xlab('Percent Bound by Osa') +
theme(legend.position = 'top',
legend.key.size = unit(1, 'cm'),
legend.text = element_text(size = 15),
legend.title = element_text(size = 20),
panel.background = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
#           axis.text.y = element_text(size = 12),
panel.grid = element_blank()) +
NULL
fn = paste0('rPlots/3E_',i,'.png')
ggsave(fn, width = 6, height = 1.5, units = 'in', dpi = 300 )
})
}
## .bed out
osaPeaks %>%
data.frame() %>%
dplyr::select(seqnames, start, end) %>%
write.table('osaPeaks.bed', quote = F, col.names = F, row.names = F, sep = '\t')
osaPeaks.full %>%
data.frame() %>%
dplyr::select(seqnames, start, end) %>%
write.table('osaPeaks-full.bed', quote = F, col.names = F, row.names = F, sep = '\t')
peaks$cnr.df %>%
data.frame() %>%
dplyr::filter(yw.cnr) %>%
dplyr::select(seqnames, start, end) %>%
write.table('controlPeaks.bed', quote = F, col.names = F, row.names = F, sep = '\t')
#fairePeaks.osaDependent %>%
#  data.frame() %>%
#  dplyr::select(seqnames, start, end) %>%
#  write.table('osaDependent.bed', quote = F, col.names = F, row.names = F, sep = '\t')
#
#fairePeaks.osaEctopic %>%
#  data.frame() %>%
#  dplyr::select(seqnames, start, end) %>%
#  write.table('osaEctopic.bed', quote = F, col.names = F, row.names = F, sep = '\t')
#
## gviz
mckay_enhancers <- read.table('bed/cloned_enhancers_dm6.bed', sep = '\t')
Delta_enhancers <- read.table('bed/cloned_Delta_enhancers.bed', sep = '\t')
espl_enhancers <- read.table('bed/espl_enhancers-merge.bed', sep = '\t')
enhancers <- dplyr::bind_rows(Delta_enhancers, espl_enhancers)
colnames(enhancers) <- c('seqnames', 'start','end','name')
enhancer.ranges <- GRanges(enhancers)
enhancertrack <- Gviz::AnnotationTrack(range = enhancer.ranges,
genome = 'dm6',
fill = '#2febeb',
col = 'transparent',
bakcground.title = 'white',
showTitle = F)
genetrack <- Gviz::GeneRegionTrack(range = dm6.TxDb, fill = 'grey80', showTitle = F, background.title = 'white', stacking = 'squish')
peakTrack <- Gviz::AnnotationTrack(range = osaPeaks.full,
genome = 'dm6',
fill = '#D01C8B',
col = 'transparent',
background.title = 'white',
showTitle = F )
spacer <- Gviz::AnnotationTrack(background.title = 'white')
## matrices for heatmaps
mats <- purrr::map(bws, ~{
normalizeToMatrix(., osaPeaks, value_column = 'score', keep = c(0.01, 0.99), extend = 2000)
})
names(mats) <- names(bws)
dl_quant2 <- read.csv('../delta/code/quant.csv')
dl_quant2
dl_quant2 <- read.csv('../delta/code/quant.csv') %>%
dplyr::mutate(sampleID = paste(date,genotype,img,sep='.')) %>%
dplyr::group_by(sampleID) %>%
dplyr::summarise(ratio = mean[side == 'a']/mean[side == 'p'])
dl_quant2
dl_quant2 <- read.csv('../delta/code/quant.csv') %>%
dplyr::mutate(sampleID = paste(date,genotype,img,sep='.')) %>%
dplyr::group_by(sampleID,genotype) %>%
dplyr::summarise(ratio = mean[side == 'a']/mean[side == 'p'])
dl_quant2
dl_quant2 %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot() +
geom_point()
dl_quant_ratio <- dl_quant2 %>%
dplyr::group_by(sampleID,genotype) %>%
dplyr::summarise()
dl_quant_ratio
dl_quant_ratio <- dl_quant2 %>%
dplyr::group_by(sampleID,genotype) %>%
dplyr::summarise(ratio = mean[side == 'a']/mean[side == 'p'])
dl_quant_ratio <- dl_quant2 %>%
dplyr::group_by(sampleID,genotype) %>%
dplyr::summarise(ratio = mean[side == 'a']/mean[side == 'p'])
dl_quant2 <- read.csv('../delta/code/quant.csv') %>%
dplyr::mutate(sampleID = paste(date,genotype,img,sep='.'))
dl_quant_ratio <- dl_quant2 %>%
dplyr::group_by(sampleID,genotype) %>%
dplyr::summarise(ratio = mean[side == 'a']/mean[side == 'p'])
dl_quant2
dl_quant_ratio
dl_quant2
dl_quant_ratio
dl_quant2 <- read.csv('../delta/code/quant.csv') %>%
dplyr::mutate(sampleID = paste(date,genotype,img,sep='.'))
dl_quant_ratio <- dl_quant2 %>%
dplyr::group_by(sampleID,genotype) %>%
dplyr::summarise(ratio = mean[side == 'a']/mean[side == 'p'])
osa_dl <- dl_quant_ratio[dl_quant_ratio$genotype == 'osa',]$ratio
lexA_dl <- dl_quant_ratio[dl_quant_ratio$genotype == 'lexA',]$ratio
t.test(osa_dl, lexA_dl, paired = F)
dl_quant2 %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot() +
geom_point()
dl_quant2 <- read.csv('../delta/code/quant.csv') %>%
dplyr::mutate(sampleID = paste(date,genotype,img,sep='.'))
dl_quant_ratio <- dl_quant2 %>%
dplyr::group_by(sampleID,genotype) %>%
dplyr::summarise(ratio = mean[side == 'a']/mean[side == 'p'])
osa_dl <- dl_quant_ratio[dl_quant_ratio$genotype == 'osa',]$ratio
lexA_dl <- dl_quant_ratio[dl_quant_ratio$genotype == 'lexA',]$ratio
t.test(osa_dl, lexA_dl, paired = F)
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot() +
geom_point()
dl_quant %>%
ggplot(aes(genotype, dl_ratio)) +
geom_boxplot() +
geom_point()
dl_quant <- read.csv('../delta/code/output.csv') %>%
dplyr::mutate(log2 = log2(dl_ratio),
sampleID = paste(date, sampleID, sep = '_'))
#dplyr::filter(!sampleID %in% c('230503_lexA_a1', '230503_lexA_b1', '230508_lexA_f1', '230508_lexA_g1'))
osa_dl <- dl_quant[dl_quant$genotype == 'osa',]$dl_ratio
lexA_dl <- dl_quant[dl_quant$genotype == 'lexA',]$dl_ratio
t.test(osa_dl, lexA_dl, paired = F)
dl_quant %>%
ggplot(aes(genotype, dl_ratio)) +
geom_boxplot() +
geom_point()
osa_br <- dl_quant[dl_quant$genotype == 'osa',]$br_ratio
lexA_br <- dl_quant[dl_quant$genotype == 'lexA',]$br_ratio
t.test(osa_br, lexA_br)
dl_quant %>%
ggplot(aes(genotype, br_ratio)) +
geom_boxplot() +
geom_point(aes(color = sampleID))
dl_quant %>% dplyr::filter(genotype == 'osa')
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot() +
geom_point(position = position_jitter())
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot() +
geom_point(position = position_jitter(width = 0.5))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot() +
geom_point(position = position_jitter(width = 0.1))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot() +
geom_point(position = position_jitter(width = 0.08))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08))
dl_quant_ratio %>%
ggplot(aes('', ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
theme(axis.title = element_blank())
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
theme(axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 12))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 12))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 20),
axis.text.y = element_text(size = 12))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 20),
axis.text.y = element_text(size = 12))
ggsave('rPlots/5D.png', width = 4, height = 5, dpi = 300)
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
ggsave('rPlots/5D.png', width = 4, height = 5, dpi = 300)
ggsave('rPlots/5D.png', width = 4, height = 4, dpi = 300)
ggsave('rPlots/5D.png', width = 3, height = 4, dpi = 300)
dl_quant2 <- read.csv('../delta/code/quant.csv') %>%
dplyr::mutate(sampleID = paste(date,genotype,img,sep='.'))
dl_quant_ratio <- dl_quant2 %>%
dplyr::group_by(sampleID,genotype) %>%
dplyr::summarise(ratio = mean[side == 'a']/mean[side == 'p'])
osa_dl <- dl_quant_ratio[dl_quant_ratio$genotype == 'osa',]$ratio
lexA_dl <- dl_quant_ratio[dl_quant_ratio$genotype == 'lexA',]$ratio
t.test(osa_dl, lexA_dl, paired = F)
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
ggsave('rPlots/5D.png', width = 3, height = 4, dpi = 300)
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
annotate(geom = 'segment', x = 1, xend = 2, y = 1.5, yend = 1.5) +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
annotate(geom = 'segment', x = 1, xend = 2, y = 1.5, yend = 1.5) +
annotate(geom = 'text', x = 1.5, xend = 1.5, y = 1.6, yend = 1.6) +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
annotate(geom = 'segment', x = 1, xend = 2, y = 1.5, yend = 1.5) +
annotate(geom = 'text', x = 1.5, y = 1.6, label = '***') +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
annotate(geom = 'segment', x = 1, xend = 2, y = 1.5, yend = 1.5) +
annotate(geom = 'text', x = 1.5, y = 1.55, label = '***') +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
annotate(geom = 'segment', x = 1, xend = 2, y = 1.5, yend = 1.5) +
annotate(geom = 'text', x = 1.5, y = 1.51, label = '***') +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
ggsave('rPlots/5D.png', width = 3, height = 4, dpi = 300)
ggsave('rPlots/5D.png', width = 3, height = 3, dpi = 300)
4
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
annotate(geom = 'segment', x = 1, xend = 2, y = 1.5, yend = 1.5) +
annotate(geom = 'text', x = 1.5, y = 1.51, label = '***') +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
ggsave('rPlots/5D.png', width = 3, height = 4, dpi = 300)
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
scale_fill_manual(values = c('#CC0066','grey60')) +
annotate(geom = 'segment', x = 1, xend = 2, y = 1.5, yend = 1.5) +
annotate(geom = 'text', x = 1.5, y = 1.51, label = '***') +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
scale_fill_manual(values = c('grey60','#CC0066')) +
annotate(geom = 'segment', x = 1, xend = 2, y = 1.5, yend = 1.5) +
annotate(geom = 'text', x = 1.5, y = 1.51, label = '***') +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
ggsave('rPlots/5D.png', width = 3, height = 4, dpi = 300)
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
scale_fill_manual(values = c('grey60','#CC0066'), name = 'RNAi') +
annotate(geom = 'segment', x = 1, xend = 2, y = 1.5, yend = 1.5) +
annotate(geom = 'text', x = 1.5, y = 1.51, label = '***') +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
ggsave('rPlots/5D.png', width = 3, height = 4, dpi = 300)
dl_quant_ratio
dl_quant_ratio %>%
dplyr::filter(genotype == 'lexA')
dl_quant_ratio %>%
dplyr::filter(genotype == 'osa')
dl_quant2 <- read.csv('../delta/code/quant.csv') %>%
dplyr::mutate(sampleID = paste(date,genotype,img,sep='.'))
dl_quant_ratio <- dl_quant2 %>%
dplyr::group_by(sampleID,genotype) %>%
dplyr::summarise(ratio = mean[side == 'a']/mean[side == 'p'])
osa_dl <- dl_quant_ratio[dl_quant_ratio$genotype == 'osa',]$ratio
lexA_dl <- dl_quant_ratio[dl_quant_ratio$genotype == 'lexA',]$ratio
t.test(osa_dl, lexA_dl, paired = F)
dl_quant_ratio %>%
ggplot(aes(genotype, ratio)) +
geom_boxplot(aes(fill = genotype)) +
geom_point(position = position_jitter(width = 0.08)) +
scale_fill_manual(values = c('grey60','#CC0066'), name = 'RNAi') +
annotate(geom = 'segment', x = 1, xend = 2, y = 1.5, yend = 1.5) +
annotate(geom = 'text', x = 1.5, y = 1.51, label = '***') +
ylab('Dl A/P Ratio') +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 12))
ggsave('rPlots/5D.png', width = 3, height = 4, dpi = 300)
dl_quant_ratio %>%
dplyr::filter(genotype == 'osa')
set.seed(5)
osaPeaks.noMeta <- osaPeaks.full
mcols(osaPeaks.noMeta) <- NULL
osa.boot <- nullranges::bootRanges(osaPeaks.noMeta,
blockLength = 500,
withinChrom = T,
R = 50)
osa.boot.anno <- ChIPseeker::annotatePeak(osa.boot,
tssRegion = c(-100,500),
TxDb=dm6.TxDb,
level = 'gene',
annoDb = "org.Dm.eg.db")
osa.boot.anno <- ChIPseeker::as.GRanges(osa.boot.anno) %>%
data.frame() %>%
dplyr::rowwise() %>%
dplyr::mutate(anno.new = dplyr::case_when(grepl("3' UTR", annotation) ~ "3' UTR",
grepl("5' UTR", annotation) ~ "5' UTR",
grepl("Distal Intergenic", annotation) ~ "Distal Intergenic",
grepl("Downstream", annotation) ~ "Downstream",
grepl("Exon", annotation) ~ "Exon",
grepl("Intron", annotation) ~ "Intron",
grepl("Promoter \\(2-3kb\\)", annotation) ~ "Promoter (2-3kb)", #why is this not working???
grepl("Promoter", annotation) ~ "Promoter"),
assay = 'boot')
anno.df <- dplyr::bind_rows(data.frame(osaPeaks), osa.boot.anno, peaks$dm6.500bp) %>%
dplyr::filter(assay == 'cnr' & osa.cnr & !yw.cnr | assay == '500bp background' | assay == 'boot') %>%
dplyr::group_by(assay, anno.new) %>%
dplyr::tally() %>%
dplyr::mutate(pct = n/sum(n),
sum = sum(n))
#                assay = ifelse(assay == 'cnr', 'Osa', '500bp Bkg'))
anno.df %>%
ggplot(aes(x = '', y = n, fill = anno.new)) +
geom_bar(stat = 'identity', position = 'fill', color = 'black') +
geom_text_repel(aes(label= ifelse(pct > 0.07, paste0(sprintf("%1.1f", pct*100),"%"),'')),
position=position_fill(vjust=0.5),
colour="black", size =5,
min.segment.length = 0,
force = 0.01,
force_pull = 1) +
scale_fill_brewer(palette = 'Spectral') +
#  scale_fill_manual(values = cbPalette.ibm) +
ylab('Fraction') +
guides(fill = guide_legend(byrow = TRUE)) +
theme(axis.title.x = element_blank(),
legend.title = element_blank(),
legend.key.size = unit(0.6, 'cm'),
legend.spacing.y = unit(0.1, 'cm'),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title.y = element_blank(),
panel.background = element_blank(),
strip.text = element_text(size = 12)) +
facet_grid(~assay)
ggsave('rPlots/3C.png', width = 5, height = 4, units = 'in', dpi = 300)
####
#stats
# two-proportion z-test -- are proportions of different annotations the same between background and osa cnr?
###
ztest <- purrr::map(unique(anno.df$anno.new), function(x) {
df <- anno.df %>% dplyr::filter(anno.new == x)
bkg.count <- df[df$assay=='boot',]$n
bkg.trial <- df[df$assay=='boot',]$sum
cnr.count <- df[df$assay=='cnr',]$n
cnr.trial <- df[df$assay=='cnr',]$sum
ztest <- prop.test(c(bkg.count, cnr.count), c(bkg.trial, cnr.trial), correct = F)
out <- data.frame(anno = x,
p = ztest$p.value)
return(out)
}) %>%
dplyr::bind_rows()
ztest %>%
dplyr::mutate(logp = -log(p),
sigp = signif(p, digits = 2),
anno = factor(anno, levels = c("3' UTR",
"5' UTR",
"Distal Intergenic",
"Downstream",
"Exon",
"Intron",
"Promoter"))) %>%
ggplot(aes('', y = anno, fill = p)) +
geom_tile() +
geom_text(aes(label = sigp)) +
scale_fill_viridis_c(direction = -1, option = "heat") +
xlab('pValue') +
theme(legend.position = 'none',
axis.title.y = element_blank(),
axis.title.x = element_text(size = 12),
axis.text = element_text(size = 12),
axis.ticks = element_blank())
ggsave('rPlots/S3-annotation-zTest.png', width = 3, height = 5, dpi = 300)
osa.boot
osa.boot.anno$anno.new
osa.boot
osa.boot.anno
osa.boot.anno %>% dplyr::filter(grepl('Promoter', annotation))
osa.boot.anno %>% dplyr::filter(grepl('Promoter', annotation)) %>% .$annotation %>% unique()
