#scale_fill_manual(values = c("#f059a2",'#1fb800','white')) +
xlab("log2 (brD KD/WT)") +
#  annotation_custom(summary_grob, xmin = 10, xmax = 20, ymin = 5, ymax = 0) +
theme(axis.text.y = element_text(size = 8, ),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom')
nr %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT),
log2 = log2(KDtoWT),
id = forcats::fct_reorder(id, log2)) %>%
#ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
ggplot(aes(log2, forcats::fct_reorder(id, log2) )) +
geom_vline(xintercept = 0, color = "grey50") +
#  ylim(c(-1,6)) +
#geom_boxplot(aes(fill = complex_general), outlier.shape = NA) +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
#  scale_y_continuous(trans = "log2") +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
#scale_fill_manual(values = c("#f059a2",'#1fb800','white')) +
xlab("log2 (brD KD/WT)") +
#  annotation_custom(summary_grob, xmin = 10, xmax = 20, ymin = 5, ymax = 0) +
theme(axis.text.y = element_text(size = 8, ),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom')
ggsave('r_out/kd_wt-brmComplex-horizontal-plot-GENERAL.png', width = 3, height = 6)
ggsave('r_out/kd_wt-brmComplex-horizontal-plot-GENERAL.png', width = 4, height = 6)
ggsave('r_out/kd_wt-brmComplex-horizontal-plot-GENERAL.png', width = 4, height = 8)
nr %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT),
log2 = log2(KDtoWT),
id = forcats::fct_reorder(id, log2)) %>%
#ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
ggplot(aes(log2, forcats::fct_reorder(id, log2) )) +
geom_vline(xintercept = 0, color = "grey50") +
#  ylim(c(-1,6)) +
#geom_boxplot(aes(fill = complex_general), outlier.shape = NA) +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
#  scale_y_continuous(trans = "log2") +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
#scale_fill_manual(values = c("#f059a2",'#1fb800','white')) +
xlab("log2 (brD KD/WT)") +
#  annotation_custom(summary_grob, xmin = 10, xmax = 20, ymin = 5, ymax = 0) +
theme(axis.text.y = element_text(size = 10, ),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom')
ggsave('r_out/kd_wt-brmComplex-horizontal-plot-GENERAL.png', width = 5, height = 8)
nr %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024")
outdata <- read.csv('../output/resultsDF.csv') %>%
dplyr::mutate(id = paste(symbol, line, sep = "_"),
nucleosome_remodeler = ifelse(symbol %in% nucleosome_remod, T, F),
Negcontrol = dplyr::case_when(symbol %in% control ~ 'Negative-Control',
T ~ 'test'),
complex_general = dplyr::case_when(symbol %in% brm_complex | symbol %in% pbap_complex | symbol %in% bap_complex ~ 'PBAP/BAP',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
complex = dplyr::case_when(symbol %in% brm_complex ~ 'core',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
other_complex = dplyr::case_when(symbol %in% brm_complex ~ '(p)bap',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
symbol %in% ino80 ~ 'Ino80',
symbol %in% dom ~ 'Domino',
symbol %in% atac ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% ACF ~ 'ACF',
symbol %in% NURD ~ 'NURD',
symbol %in% NORC ~ 'NORC',
symbol %in% demethyl ~ 'Demethylase',
T ~ 'other')) %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT),
log2 = log2(KDtoWT),
bap_hits = dplyr::case_when(avg > 1 & complex_general == 'PBAP/BAP' ~ 'Brahma Complex',
complex_general == 'Negative-Control' ~ 'Negative-Control',
T ~ 'other'))
outdata <- read.csv('../output/resultsDF.csv') %>%
dplyr::mutate(id = paste(symbol, line, sep = "_"),
nucleosome_remodeler = ifelse(symbol %in% nucleosome_remod, T, F),
Negcontrol = dplyr::case_when(symbol %in% control ~ 'Negative-Control',
T ~ 'test'),
complex_general = dplyr::case_when(symbol %in% brm_complex | symbol %in% pbap_complex | symbol %in% bap_complex ~ 'PBAP/BAP',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
complex = dplyr::case_when(symbol %in% brm_complex ~ 'core',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
other_complex = dplyr::case_when(symbol %in% brm_complex ~ '(p)bap',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
symbol %in% ino80 ~ 'Ino80',
symbol %in% dom ~ 'Domino',
symbol %in% atac ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% ACF ~ 'ACF',
symbol %in% NURD ~ 'NURD',
symbol %in% NORC ~ 'NORC',
symbol %in% demethyl ~ 'Demethylase',
T ~ 'other')) %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT),
log2 = log2(KDtoWT),
bap_hits = dplyr::case_when(log2 => 0.5 & complex_general == 'PBAP/BAP' ~ 'Brahma Complex',
outdata <- read.csv('../output/resultsDF.csv') %>%
dplyr::mutate(id = paste(symbol, line, sep = "_"),
nucleosome_remodeler = ifelse(symbol %in% nucleosome_remod, T, F),
Negcontrol = dplyr::case_when(symbol %in% control ~ 'Negative-Control',
T ~ 'test'),
complex_general = dplyr::case_when(symbol %in% brm_complex | symbol %in% pbap_complex | symbol %in% bap_complex ~ 'PBAP/BAP',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
complex = dplyr::case_when(symbol %in% brm_complex ~ 'core',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
other_complex = dplyr::case_when(symbol %in% brm_complex ~ '(p)bap',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
symbol %in% ino80 ~ 'Ino80',
symbol %in% dom ~ 'Domino',
symbol %in% atac ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% ACF ~ 'ACF',
symbol %in% NURD ~ 'NURD',
symbol %in% NORC ~ 'NORC',
symbol %in% demethyl ~ 'Demethylase',
T ~ 'other')) %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT),
log2 = log2(KDtoWT),
bap_hits = dplyr::case_when(log2 >= 0.5 & complex_general == 'PBAP/BAP' ~ 'Brahma Complex',
complex_general == 'Negative-Control' ~ 'Negative-Control',
T ~ 'other'))
outdata
outdata <- read.csv('../output/resultsDF.csv') %>%
dplyr::mutate(id = paste(symbol, line, sep = "_"),
nucleosome_remodeler = ifelse(symbol %in% nucleosome_remod, T, F),
Negcontrol = dplyr::case_when(symbol %in% control ~ 'Negative-Control',
T ~ 'test'),
complex_general = dplyr::case_when(symbol %in% brm_complex | symbol %in% pbap_complex | symbol %in% bap_complex ~ 'PBAP/BAP',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
complex = dplyr::case_when(symbol %in% brm_complex ~ 'core',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
other_complex = dplyr::case_when(symbol %in% brm_complex ~ '(p)bap',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
symbol %in% ino80 ~ 'Ino80',
symbol %in% dom ~ 'Domino',
symbol %in% atac ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% ACF ~ 'ACF',
symbol %in% NURD ~ 'NURD',
symbol %in% NORC ~ 'NORC',
symbol %in% demethyl ~ 'Demethylase',
T ~ 'other')) %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
dplyr::group_by(id) %>%
dplyr::mutate(med = median(KDtoWT),
log2 = log2(KDtoWT),
bap_hits = dplyr::case_when(log2 >= 0.5 & complex_general == 'PBAP/BAP' ~ 'Brahma Complex',
complex_general == 'Negative-Control' ~ 'Negative-Control',
T ~ 'other'))
outdata
nr %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(#med = median(KDtoWT),
# log2 = log2(KDtoWT),
id = forcats::fct_reorder(id, log2)) %>%
#ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
ggplot(aes(log2, forcats::fct_reorder(id, log2) )) +
geom_vline(xintercept = 0, color = "grey50") +
#  ylim(c(-1,6)) +
#geom_boxplot(aes(fill = complex_general), outlier.shape = NA) +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
#  scale_y_continuous(trans = "log2") +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
#scale_fill_manual(values = c("#f059a2",'#1fb800','white')) +
xlab("log2 (brD KD/WT)") +
#  annotation_custom(summary_grob, xmin = 10, xmax = 20, ymin = 5, ymax = 0) +
theme(axis.text.y = element_text(size = 10, ),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom')
nr %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
#  dplyr::mutate(#med = median(KDtoWT),
# log2 = log2(KDtoWT),
#  id = forcats::fct_reorder(id, log2)) %>%
#ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
ggplot(aes(log2, forcats::fct_reorder(id, log2) )) +
geom_vline(xintercept = 0, color = "grey50") +
#  ylim(c(-1,6)) +
#geom_boxplot(aes(fill = complex_general), outlier.shape = NA) +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
#  scale_y_continuous(trans = "log2") +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
#scale_fill_manual(values = c("#f059a2",'#1fb800','white')) +
xlab("log2 (brD KD/WT)") +
#  annotation_custom(summary_grob, xmin = 10, xmax = 20, ymin = 5, ymax = 0) +
theme(axis.text.y = element_text(size = 10, ),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom')
nr %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
#  dplyr::group_by(symbol, line) %>%
#  dplyr::mutate(#med = median(KDtoWT),
# log2 = log2(KDtoWT),
#  id = forcats::fct_reorder(id, log2)) %>%
#ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
ggplot(aes(log2, forcats::fct_reorder(id, log2) )) +
geom_vline(xintercept = 0, color = "grey50") +
#  ylim(c(-1,6)) +
#geom_boxplot(aes(fill = complex_general), outlier.shape = NA) +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
#  scale_y_continuous(trans = "log2") +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
#scale_fill_manual(values = c("#f059a2",'#1fb800','white')) +
xlab("log2 (brD KD/WT)") +
#  annotation_custom(summary_grob, xmin = 10, xmax = 20, ymin = 5, ymax = 0) +
theme(axis.text.y = element_text(size = 10, ),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom')
nr %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
#  dplyr::group_by(symbol, line) %>%
#  dplyr::mutate(#med = median(KDtoWT),
# log2 = log2(KDtoWT),
#  id = forcats::fct_reorder(id, log2)) %>%
#ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
ggplot(aes(log2, id) )) +
nr %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
#  dplyr::group_by(symbol, line) %>%
#  dplyr::mutate(#med = median(KDtoWT),
# log2 = log2(KDtoWT),
#  id = forcats::fct_reorder(id, log2)) %>%
#ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
ggplot(aes(log2, id) ) +
geom_vline(xintercept = 0, color = "grey50") +
#  ylim(c(-1,6)) +
#geom_boxplot(aes(fill = complex_general), outlier.shape = NA) +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
#  scale_y_continuous(trans = "log2") +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
#scale_fill_manual(values = c("#f059a2",'#1fb800','white')) +
xlab("log2 (brD KD/WT)") +
#  annotation_custom(summary_grob, xmin = 10, xmax = 20, ymin = 5, ymax = 0) +
theme(axis.text.y = element_text(size = 10, ),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom')
nr <- outdata %>% dplyr::filter(nucleosome_remodeler | Negcontrol == 'Negative-Control')
nr %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
# dplyr::group_by(symbol, line) %>%
# dplyr::mutate(med = median(KDtoWT),
#               log2 = log2(KDtoWT),
#               id = forcats::fct_reorder(id, log2)) %>%
#ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
ggplot(aes(log2, forcats::fct_reorder(id, log2) )) +
geom_vline(xintercept = 0, color = "grey50") +
#  ylim(c(-1,6)) +
#geom_boxplot(aes(fill = complex_general), outlier.shape = NA) +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
#  scale_y_continuous(trans = "log2") +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
#scale_fill_manual(values = c("#f059a2",'#1fb800','white')) +
xlab("log2 (brD KD/WT)") +
#  annotation_custom(summary_grob, xmin = 10, xmax = 20, ymin = 5, ymax = 0) +
theme(axis.text.y = element_text(size = 10, ),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom')
outdata
outdata  %>% dplyr::filter(grepl('32372',id))
outdata <- read.csv('../output/resultsDF.csv') %>%
dplyr::mutate(id = paste(symbol, line, sep = "_"),
nucleosome_remodeler = ifelse(symbol %in% nucleosome_remod, T, F),
Negcontrol = dplyr::case_when(symbol %in% control ~ 'Negative-Control',
T ~ 'test'),
complex_general = dplyr::case_when(symbol %in% brm_complex | symbol %in% pbap_complex | symbol %in% bap_complex ~ 'PBAP/BAP',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
complex = dplyr::case_when(symbol %in% brm_complex ~ 'core',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
other_complex = dplyr::case_when(symbol %in% brm_complex ~ '(p)bap',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
symbol %in% ino80 ~ 'Ino80',
symbol %in% dom ~ 'Domino',
symbol %in% atac ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% ACF ~ 'ACF',
symbol %in% NURD ~ 'NURD',
symbol %in% NORC ~ 'NORC',
symbol %in% demethyl ~ 'Demethylase',
T ~ 'other')) %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
dplyr::group_by(id) %>%
dplyr::mutate(med = median(KDtoWT),
log2 = log2(KDtoWT),
meanlog2 = mean(log2))
outdata  %>% dplyr::filter(grepl('32372',id))
outdata
outdata <- read.csv('../output/resultsDF.csv') %>%
dplyr::mutate(id = paste(symbol, line, sep = "_"),
nucleosome_remodeler = ifelse(symbol %in% nucleosome_remod, T, F),
Negcontrol = dplyr::case_when(symbol %in% control ~ 'Negative-Control',
T ~ 'test'),
complex_general = dplyr::case_when(symbol %in% brm_complex | symbol %in% pbap_complex | symbol %in% bap_complex ~ 'PBAP/BAP',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
complex = dplyr::case_when(symbol %in% brm_complex ~ 'core',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
other_complex = dplyr::case_when(symbol %in% brm_complex ~ '(p)bap',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
symbol %in% ino80 ~ 'Ino80',
symbol %in% dom ~ 'Domino',
symbol %in% atac ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% ACF ~ 'ACF',
symbol %in% NURD ~ 'NURD',
symbol %in% NORC ~ 'NORC',
symbol %in% demethyl ~ 'Demethylase',
T ~ 'other')) %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
dplyr::group_by(id) %>%
dplyr::mutate(log2 = log2(KDtoWT),
meanlog2 = mean(log2),
bap_hits = dplyr::case_when(meanlog2 >= 0.5 & complex_general == 'PBAP/BAP' ~ 'Brahma Complex',
complex_general == 'Negative-Control' ~ 'Negative-Control',
T ~ 'other'))
nr %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
# dplyr::group_by(symbol, line) %>%
# dplyr::mutate(med = median(KDtoWT),
#               log2 = log2(KDtoWT),
#               id = forcats::fct_reorder(id, log2)) %>%
#ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
ggplot(aes(log2, forcats::fct_reorder(id, log2) )) +
geom_vline(xintercept = 0, color = "grey50") +
#  ylim(c(-1,6)) +
#geom_boxplot(aes(fill = complex_general), outlier.shape = NA) +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
#  scale_y_continuous(trans = "log2") +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
#scale_fill_manual(values = c("#f059a2",'#1fb800','white')) +
xlab("log2 (brD KD/WT)") +
#  annotation_custom(summary_grob, xmin = 10, xmax = 20, ymin = 5, ymax = 0) +
theme(axis.text.y = element_text(size = 10, ),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom')
nr <- outdata %>% dplyr::filter(nucleosome_remodeler | Negcontrol == 'Negative-Control')
nr %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
# dplyr::group_by(symbol, line) %>%
# dplyr::mutate(med = median(KDtoWT),
#               log2 = log2(KDtoWT),
#               id = forcats::fct_reorder(id, log2)) %>%
#ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
ggplot(aes(log2, forcats::fct_reorder(id, log2) )) +
geom_vline(xintercept = 0, color = "grey50") +
#  ylim(c(-1,6)) +
#geom_boxplot(aes(fill = complex_general), outlier.shape = NA) +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
#  scale_y_continuous(trans = "log2") +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
#scale_fill_manual(values = c("#f059a2",'#1fb800','white')) +
xlab("log2 (brD KD/WT)") +
#  annotation_custom(summary_grob, xmin = 10, xmax = 20, ymin = 5, ymax = 0) +
theme(axis.text.y = element_text(size = 10, ),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom')
ggsave('r_out/kd_wt-brmComplex-horizontal-plot-GENERAL.png', width = 5, height = 8)
outdata <- read.csv('../output/resultsDF.csv') %>%
dplyr::mutate(id = paste(symbol, line, sep = "_"),
nucleosome_remodeler = ifelse(symbol %in% nucleosome_remod, T, F),
Negcontrol = dplyr::case_when(symbol %in% control ~ 'Negative-Control',
T ~ 'test'),
complex_general = dplyr::case_when(symbol %in% brm_complex | symbol %in% pbap_complex | symbol %in% bap_complex ~ 'PBAP/BAP',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
complex = dplyr::case_when(symbol %in% brm_complex ~ 'core',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
T ~ 'other'),
other_complex = dplyr::case_when(symbol %in% brm_complex ~ '(p)bap',
symbol %in% pbap_complex ~ 'pbap',
symbol %in% bap_complex ~ 'bap',
symbol %in% control ~ 'Negative-Control',
symbol %in% ino80 ~ 'Ino80',
symbol %in% dom ~ 'Domino',
symbol %in% atac ~ 'ATAC',
symbol %in% NURF ~ 'NURF',
symbol %in% ACF ~ 'ACF',
symbol %in% NURD ~ 'NURD',
symbol %in% NORC ~ 'NORC',
symbol %in% demethyl ~ 'Demethylase',
T ~ 'other')) %>%
dplyr::filter(stack >= 10 & gfp >= 8 & size == "1024x1024") %>%
dplyr::group_by(id) %>%
dplyr::mutate(log2 = log2(KDtoWT),
meanlog2 = mean(log2),
bap_hits = dplyr::case_when(meanlog2 >= 0.585 & complex_general == 'PBAP/BAP' ~ 'Brahma Complex', #increase of atleast 150%
complex_general == 'Negative-Control' ~ 'Negative-Control',
T ~ 'other'))
nr <- outdata %>% dplyr::filter(nucleosome_remodeler | Negcontrol == 'Negative-Control')
outdata %>%
dplyr::filter(stack >= 10 &
gfp >= 8 &
size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(KDtoWT, forcats::fct_reorder(id, KDtoWT))) +
geom_vline(xintercept = 1, color = "grey50") +
geom_boxplot(aes(fill = complex), outlier.shape = NA) +
scale_y_discrete(position = 'right') +
scale_x_continuous(trans = "log2") +
scale_fill_manual(values = color_scale) +
xlab("log2(KD/WT)") +
ylab("brDisc KD/WT") +
theme(#axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
#        legend.position = "none",
axis.text.y = element_text(size = 10),
axis.title.y = element_blank())
nr %>%
ggplot(aes(log2, forcats::fct_reorder(id, log2) )) +
geom_vline(xintercept = 0, color = "grey50") +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
xlab("log2 (brD KD/WT)") +
theme(axis.text.y = element_text(size = 10, ),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom')
ggsave('r_out/kd_wt-brmComplex-horizontal-plot-GENERAL.png', width = 5, height = 8)
nr %>%
ggplot(aes(log2, forcats::fct_reorder(id, log2) )) +
geom_vline(xintercept = 0, color = "grey50") +
geom_vline(xintercept = 0.585, color = "grey50", linetype = "longdash") +
geom_boxplot(aes(fill = bap_hits), outlier.size = 0.5) +
scale_fill_manual(values = c("#66C2A6",'#F059A2','white')) +
xlab("log2 (brD KD/WT)") +
theme(axis.text.y = element_text(size = 10, ),
axis.title.y = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'grey10'),
panel.grid.major  = element_line(color = 'grey90'),
legend.title = element_blank(),
legend.position = 'bottom')
ggsave('r_out/kd_wt-brmComplex-horizontal-plot-GENERAL.png', width = 5, height = 8)
